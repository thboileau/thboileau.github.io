<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
<title>Restlet framework | Authentication</title>

  
  
    
      <link rel="stylesheet" href="/css/app.min.css">
    
  



<link rel="stylesheet" type="text/css" href="/css/vendor/magnific-popup.css">

<link rel="stylesheet" href="/css/custom.css" />
<link rel="stylesheet" href="/css/app.min.css">
<link rel="stylesheet" href="/css/vendor/prism.css" />
<link rel="stylesheet" href="/css/vendor/component.css" />


      <script src="/js/main.js"></script>


</head>
<body class="static-nav documentation">

  <nav class="m-navigation m-navigation-site m-navigation-fixed" role="navigation">
  <div class="container-fluid">
    <div class="navigation-group">
      <a class="navigation-logo" href="/"><img src="/images/navbarTop.svg"></a>
      <span id="j-navigation-trigger" class="navigation-trigger"></span>
      <ul class="navigation-list navigation-list-right">
        <li class=""><a class="navigation__link" href="/features">Features</a></li>
        <li class="">
          <a class="navigation__link" href="/downloads/current">Download</a>
        </li>
        <li class="">
            <a class="navigation__link" href="/documentation/tutorials/2.5/">Documentation</a></li>
      </ul>
    </div>
  </div>
</nav>


<main id="main" role="main">
  <div class="documentation-wrapper">
<div class="sidebar-wrapper hidden-xs hidden-sm">
  <aside class="section-bg-mako text-white">
    <nav class="documentation-sidebar" aria-label="Documentation navigation" role="navigation">
      <ul id="accordion" class="nav documentation-nav">
        <li>
          <a href="#submenu-1" class="accordion-toggle toggle-switch"><img src="/images/restlet_white_32.svg">Framework</a>
          <ul id="submenu-1" class="nav panel-switch" role="menu">
            <li>
              <a href="#subsubmenu-1" class="accordion-toggle toggle-switch">User guide</a>
              <ul id="subsubmenu-1" class="nav panel-switch lowest-lewel" role="menu">
                <li><a href="/documentation/user-guide/2.2/introduction/overview" >Part 1 - Introduction</a></li>
                <li><a href="/documentation/user-guide/2.2/core/overview" class="active" >Part 2 - Core Restlet</a></li>
                <li><a href="/documentation/user-guide/2.2/editions/overview" >Part 3 - Restlet Editions</a></li>
                <li><a href="/documentation/user-guide/2.2/extensions/overview" >Part 4 - Restlet Extensions</a></li>
                <li><a href="/documentation/user-guide/2.2/appendices/glossary">Appendices</a></li>
              </ul>
            </li>
            <li><a href="/documentation/tutorials/2.2/overview" >Tutorials</a></li>
            <li><a href="/documentation/javadocs/2.2/" >Javadocs</a></li>
            <li><a target="_blank" href="/documentation/2.2/changelog">Change Log</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </aside>

</div>

<div class="content-wrapper section-bg-white">
  <div class="row hidden-xs hidden-sm">
  <div class="col-md-12">
    <div class="h-cta h-cta--large section-bg-grey">
      <img class="large" src="/images/restlet-framework-dark.svg" alt="Restlet Framework">
      <a href="/downloads/current" class="m-button m-button-flat-green pull-right">Install Framework</a>
    </div>
  </div>
</div>

  <div class="mobile-nav hidden-md hidden-lg">
  <div class="dl-menu-container in-content">
    <div id="dl-menu" class="dl-menuwrapper">
      <button class="dl-trigger">Open Menu</button>
      <ul class="dl-menu">
        <li class="">
          <a href="#">User guide</a>
          <ul class="dl-submenu">
            <li>mobile-nav</li>


      </ul>
    </div>
  </div>
</div>


  <div class="row">
    <div class="col-md-3">
      
<nav class="inner-nav hidden-xs hidden-sm">
  <ul class="content-nav">
    
<nav class="inner-nav hidden-xs hidden-sm">
  <ul class="content-nav">
    <li>
      <a href="/documentation/user-guide/2.4/introduction/overview/">Overview</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/features/">Features</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/">What&#39;s new</a>
        <ul>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.4/">In version 2.4</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.3/">In version 2.3</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.2/">In version 2.2</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.1/">In version 2.1</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.0/">2</a>
        <ul>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.0/api/">API improvements</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.0/engine/">Engine</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.0/extensions/">Extensions</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.0/editions/">Editions</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.0/misc/">Misc</a>
    </li>
    <li>
      <a href="/documentation/user-guide/2.4/introduction/whats-new/2.0/migration/">Migration</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
  </ul>
</nav>

  </ul>
</nav>

    </div>
    <div class="col-md-9">
      <div class="documentation-content">
        

        <h1>Authentication</h1>
        <h1 id="introduction">Introduction</h1>
<p>There are two commons ways to authenticate your users with your Restlet
application. The first is to use is to leverage the standard HTTP
authentication mechanism, either the Basic or the Digest authentication.
The Basic mechanism is sending the password in clear and should only be
used over a secure HTTPS channel. The second mechanism is to use a
custom authentication form and some cookie set by the server.</p>
<h1 id="http-basic-authentication">HTTP Basic authentication</h1>
<h2 id="introduction-1">Introduction</h2>
<p>Here is a very simple code illustrating a component that guards its
applications with the BASIC authentication scheme.</p>
<p>The whole code can be downloaded
<a href="https://download.restlet.talend.com/technical-resources/restlet-framework/archives/examples/authentication/2.2/sample.zip" title="testHttpBasic">here</a> (application/force-download, 1.2 kB).</p>
<h2 id="description-of-the-server-side">Description of the server side</h2>
<h3 id="component">Component</h3>
<p>The sample component is composed of two parts. The first one is a very
simple Restlet that answers to request with a &ldquo;hello, word&rdquo; text
representation. Of course this Restlet is a very simple representation
of your own complex application.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// Restlet that simply replies to requests with an &#34;hello, world&#34; text message</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>Restlet<span style="color:#bbb"> </span>restlet<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>Restlet()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f">@Override</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#0b0;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#00a000">handle</span>(Request<span style="color:#bbb"> </span>request,<span style="color:#bbb"> </span>Response<span style="color:#bbb"> </span>response)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>response.<span style="color:#b44">setEntity</span>(<span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>StringRepresentation(<span style="color:#b44">&#34;hello, world&#34;</span>,<span style="color:#bbb"> </span>MediaType.<span style="color:#b44">TEXT_PLAIN</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>};</span></span></code></pre></div>
<p>Then, the component protects this Restlet with a ChallengeAuthenticator
instance based on the BASIC authentication scheme. Once the instance is
created, it is given the list of known (login/password) pairs via the
&ldquo;verifier&rdquo; attibute.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// Guard the restlet with BASIC authentication.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>ChallengeAuthenticator<span style="color:#bbb"> </span>guard<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>ChallengeAuthenticator(<span style="color:#a2f;font-weight:bold">null</span>,<span style="color:#bbb"> </span>ChallengeScheme.<span style="color:#b44">HTTP_BASIC</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;testRealm&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// Instantiates a Verifier of identifier/secret couples based on a simple Map.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>MapVerifier<span style="color:#bbb"> </span>mapVerifier<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>MapVerifier();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// Load a single static login/secret pair.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>mapVerifier.<span style="color:#b44">getLocalSecrets</span>().<span style="color:#b44">put</span>(<span style="color:#b44">&#34;login&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;secret&#34;</span>.<span style="color:#b44">toCharArray</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>guard.<span style="color:#b44">setVerifier</span>(mapVerifier);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>guard.<span style="color:#b44">setNext</span>(restlet);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>Component<span style="color:#bbb"> </span>component<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>Component();<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>component.<span style="color:#b44">getServers</span>().<span style="color:#b44">add</span>(Protocol.<span style="color:#b44">HTTP</span>,<span style="color:#bbb"> </span>8182);<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>component.<span style="color:#b44">getDefaultHost</span>().<span style="color:#b44">attachDefault</span>(guard);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>component.<span style="color:#b44">start</span>();</span></span></code></pre></div>
<h3 id="customization">Customization</h3>
<p>As you may have noticed earlier, the list of known login/password pairs
are loaded by the authenticator via the &ldquo;verifier&rdquo; attribute via a
simple Verifier based on a Map. This is useful when the list of pairs
are known by advance and is not susceptible to change. In a more
realistic case, the credentials are hosted in a database or a LDAP
directory, etc. In this case, the responsibility to resolve the password
according to the login is deported to a class that implements the
org.restlet.security.Verifier interface.</p>
<p>The contract of the Verifier is a simple method which aims at returning
the given password according to the given login. The Restlet framework
provides an abstract implementation that retrieves the pair of
identifier/secret in the request&rsquo;s challenge response and allow to
verify them:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">import</span><span style="color:#bbb"> </span><span style="color:#00f;font-weight:bold">org.restlet.security.LocalVerifier</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">TestVerifier</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">extends</span><span style="color:#bbb"> </span>LocalVerifier<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f">@Override</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#0b0;font-weight:bold">char</span><span style="color:#666">[]</span><span style="color:#bbb"> </span><span style="color:#00a000">getLocalSecret</span>(String<span style="color:#bbb"> </span>identifier)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#080;font-style:italic">// Could have a look into a database, LDAP directory, etc.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">if</span><span style="color:#bbb"> </span>(<span style="color:#b44">&#34;login&#34;</span>.<span style="color:#b44">equals</span>(identifier))<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#a2f;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#b44">&#34;secret&#34;</span>.<span style="color:#b44">toCharArray</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">null</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div>
<h2 id="description-of-the-client-side">Description of the client side</h2>
<p>The credentials are transmitted to the request via a ChallengeResponse
object as follow:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">static</span><span style="color:#bbb"> </span><span style="color:#0b0;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#00a000">main</span>(String<span style="color:#bbb"> </span>args<span style="color:#666">[]</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>ClientResource<span style="color:#bbb"> </span>resource<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>ClientResource(<span style="color:#b44">&#34;http://localhost:8182/&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic">// Send an authenticated request using the Basic authentication scheme.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>resource.<span style="color:#b44">setChallengeResponse</span>(ChallengeScheme.<span style="color:#b44">HTTP_BASIC</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;login&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;secret&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic">// Send the request</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>resource.<span style="color:#b44">get</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic">// Should be 200</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#b44">out</span>.<span style="color:#b44">println</span>(resource.<span style="color:#b44">getStatus</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div>
<p>If you try to access http://localhost:8182/ via a web browser, a window will
appear to type in your credentials.</p>
<h1 id="http-digest-authentication">HTTP Digest authentication</h1>
<h2 id="introduction-2">Introduction</h2>
<p>Here is a very simple code illustrating a component that guards its
applications with the DIGEST authentication scheme.</p>
<p>The whole code can be downloaded
<a href="https://download.restlet.talend.com/technical-resources/restlet-framework/archives/examples/authentication/2.2/httpDigestSample.zip" title="Sample code illustrating Digest authentication">here</a> (application/force-download, 1.6 kB).</p>
<h2 id="description-of-the-server-side-1">Description of the server side</h2>
<h3 id="component-1">Component</h3>
<p>The sample component is composed of two parts. The first one is a very
simple Restlet that answers to request with a &ldquo;hello, word&rdquo; text
representation. Of course this Restlet is a very simple representation
of your own complex application.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// Restlet that simply replies to requests with an &#34;hello, world&#34; text message</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>Restlet<span style="color:#bbb"> </span>restlet<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>Restlet()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f">@Override</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#0b0;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#00a000">handle</span>(Request<span style="color:#bbb"> </span>request,<span style="color:#bbb"> </span>Response<span style="color:#bbb"> </span>response)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">         </span>response.<span style="color:#b44">setEntity</span>(<span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>StringRepresentation(<span style="color:#b44">&#34;hello, world&#34;</span>,<span style="color:#bbb"> </span>MediaType.<span style="color:#b44">TEXT_PLAIN</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>};</span></span></code></pre></div>
<p>Then, the component protects this Restlet with an Authenticator instance
based on the DIGEST authentication scheme. A dedicated constructor of
the Guard class of the Restlet API allows you to create such instance.
Once the instance is created, it is given the list of known
(login/password) pairs via the &ldquo;secrets&rdquo; attibute.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>DigestAuthenticator<span style="color:#bbb"> </span>guard<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>DigestAuthenticator(<span style="color:#a2f;font-weight:bold">null</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;TestRealm&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;mySecretServerKey&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// Instantiates a Verifier of identifier/secret couples based on a simple Map.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>MapVerifier<span style="color:#bbb"> </span>mapVerifier<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>MapVerifier();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// Load a single static login/secret pair.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>mapVerifier.<span style="color:#b44">getLocalSecrets</span>().<span style="color:#b44">put</span>(<span style="color:#b44">&#34;login&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;secret&#34;</span>.<span style="color:#b44">toCharArray</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>guard.<span style="color:#b44">setWrappedVerifier</span>(mapVerifier);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// Guard the restlet</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>guard.<span style="color:#b44">setNext</span>(restlet);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>component.<span style="color:#b44">getDefaultHost</span>().<span style="color:#b44">attachDefault</span>(guard);</span></span></code></pre></div>
<h3 id="customization-1">Customization</h3>
<p>As you may have noticed earlier, the list of known login/password pairs
are loaded by the authenticator via the &ldquo;verifier&rdquo; attribute via a
simple Verifier based on a Map. This is useful when the list of pairs
are known by advance and is not susceptible to change. In a more
realistic case, the credentials are hosted in a database or a LDAP
directory, etc. In this case, the responsibility to resolve the password
according to the login is deported to a class that implements the
org.restlet.security.Verifier interface.</p>
<p>The contract of the Verifier is a simple method which aims at returning
the given password according to the given login. The Restlet framework
provides an abstract implementation that retrieves the pair of
identifier/secret in the request&rsquo;s challenge response and allow to
verify them:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">import</span><span style="color:#bbb"> </span><span style="color:#00f;font-weight:bold">org.restlet.security.LocalVerifier</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">class</span> <span style="color:#00f">TestVerifier</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">extends</span><span style="color:#bbb"> </span>LocalVerifier<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f">@Override</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span><span style="color:#a2f;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#0b0;font-weight:bold">char</span><span style="color:#666">[]</span><span style="color:#bbb"> </span><span style="color:#00a000">getLocalSecret</span>(String<span style="color:#bbb"> </span>identifier)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">         </span><span style="color:#080;font-style:italic">// Could have a look into a database, LDAP directory, etc.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">         </span><span style="color:#a2f;font-weight:bold">if</span><span style="color:#bbb"> </span>(<span style="color:#b44">&#34;login&#34;</span>.<span style="color:#b44">equals</span>(identifier))<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">             </span><span style="color:#a2f;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#b44">&#34;secret&#34;</span>.<span style="color:#b44">toCharArray</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">         </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">         </span><span style="color:#a2f;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">null</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>}</span></span></code></pre></div>
<h2 id="description-of-the-client-side-1">Description of the client side</h2>
<p>The authentication with the DIGEST scheme is bit more difficult than the
one for the BASIC scheme. The credentials provided by the client is the
result of computation of data given by the client on one side (login and
password) and by the server on the other side (&ldquo;nonce&rdquo; value, &ldquo;realm&rdquo;
value, etc.). Unless these pieces of data are known in advance by the
client, it appears that in general a first request is required in order
to collect them.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ClientResource<span style="color:#bbb"> </span>resource<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>ClientResource(<span style="color:#b44">&#34;http://localhost:8182/&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>resource.<span style="color:#b44">setChallengeResponse</span>(ChallengeScheme.<span style="color:#b44">HTTP_DIGEST</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;login&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;secret&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span><span style="color:#080;font-style:italic">// Send the first request with unsufficient authentication.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">try</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">     </span>resource.<span style="color:#b44">get</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>}<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">catch</span><span style="color:#bbb"> </span>(ResourceException<span style="color:#bbb"> </span>re)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span><span style="color:#080;font-style:italic">// Should be 401, since the client needs some data sent by the server in</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span><span style="color:#080;font-style:italic">// order to complete the ChallengeResponse.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>System.<span style="color:#b44">out</span>.<span style="color:#b44">println</span>(resource.<span style="color:#b44">getStatus</span>());</span></span></code></pre></div>
<p>Then, the second step allows to get the required data for the final
computation of a correct ChallengeResponse object:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// Complete the challengeResponse object according to the server&#39;s data</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// 1- Loop over the challengeRequest objects sent by the server.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>ChallengeRequest<span style="color:#bbb"> </span>c1<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">null</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a2f;font-weight:bold">for</span><span style="color:#bbb"> </span>(ChallengeRequest<span style="color:#bbb"> </span>challengeRequest<span style="color:#bbb"> </span>:<span style="color:#bbb"> </span>resource.<span style="color:#b44">getChallengeRequests</span>())<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#a2f;font-weight:bold">if</span><span style="color:#bbb"> </span>(ChallengeScheme.<span style="color:#b44">HTTP_DIGEST</span>.<span style="color:#b44">equals</span>(challengeRequest.<span style="color:#b44">getScheme</span>()))<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>c1<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span>challengeRequest;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#a2f;font-weight:bold">break</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// 2- Create the Challenge response used by the client to authenticate its requests.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>ChallengeResponse<span style="color:#bbb"> </span>challengeResponse<span style="color:#bbb"> </span><span style="color:#666">=</span><span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">new</span><span style="color:#bbb"> </span>ChallengeResponse(c1,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                                                            </span>resource.<span style="color:#b44">getResponse</span>(),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                                                            </span><span style="color:#b44">&#34;login&#34;</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">                                                            </span><span style="color:#b44">&#34;secret&#34;</span>.<span style="color:#b44">toCharArray</span>());</span></span></code></pre></div>
<p>Finally, the request is completed with the computed ChallengeResponse
instance:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>resource.<span style="color:#b44">setChallengeResponse</span>(challengeResponse);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// Try authenticated request</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>resource.<span style="color:#b44">get</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">// Should be 200.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>System.<span style="color:#b44">out</span>.<span style="color:#b44">println</span>(resource.<span style="color:#b44">getStatus</span>());</span></span></code></pre></div>

      </div>
    </div>
  </div>
</div>

  </div>
</main>
    <footer>
  <div class="m-footer skew-top-black">
    <div class="container">
      <div class="row eq-height">
        <div class="col-sm-2">
          <h4>Features</h4>
          <ul>
            <li><a href="/features">Features</a></li>
          </ul>
        </div>
        <div class="col-sm-2">
          <h4>Downloads</h4>
          <ul>
            <li><a href="/downloads/current/">Current Release</a></li>
            <li><a href="/downloads/past/">Other Releases</a></li>
            <li><a href="/downloads/legal-terms/">Legal Terms</a></li>
            <li><a href="/downloads/faq/">FAQ</a></li>
          </ul>
        </div>
        <div class="col-sm-2">
          <h4>Documentation</h4>
          <ul>
            <li><a href="/documentation/user-guide/2.5/">User guide</a></li>
            <li><a href="/documentation/tutorials/2.5/">Tutorials</a></li>
            <li><a href="/documentation/javadocs/2.5/">Javadocs</a></li>
            <li><a href="/documentation/2.5/changelog">Changelog</a></li>
          </ul>
        </div>
      </div>
      <div class="row copyright">
        <div class="col-xs-12 col-md-8">
          <ul class="list-inline">
            <li>&copy; 2025 Qlik All rights reserved.</li>
          </ul>
        </div>
      </div>

    </div>
  </div>

</footer>

    <script type="text/javascript" src="/js/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="/js/modernizr-2.8.3.min.js"></script>
<script type="text/javascript" src="/js/jquery.dlmenu.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
<script type="text/javascript" src="/js/init.js"></script>
<script type="text/javascript" src="/js/prism.js" data-default-language="markup"></script>
<script type="text/javascript" src="/js/app.js"></script>
<script type="text/javascript" src="/js/downloads.js"></script>


</body>
</html>
